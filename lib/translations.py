TRANSLATIONS = {
    "en": {
        "app_title": "PDF Parser - Bank Statement Processor",
        "parser": "Parser:",
        "pdf_file": "PDF File:",
        "excel_file": "Excel File (Optional):",
        "language": "Language:",
        "select_existing_excel": "Select existing Excel file",
        "rules": "Rules:",
        "enable_rules": "Enable rules",
        "do_not_use_rules": "Do NOT use rules",
        "pattern": "Pattern",
        "category": "Category",
        "add": "Add",
        "remove_selected": "Remove Selected",
        "output_file": "Output File:",
        "sheet_name": "Sheet Name:",
        "clear_existing": "Clear chosen source Excel before writing",
        "process_pdf": "Process PDF",
        "status": "Status:",
        "browse": "Browse",
        "data": "Data",
        "details": "Details",
        "rate_nr": "Rate nr",
        "num_rates": "Number of rates",
        "store": "Store",
        "transaction_nr": "Transaction nr",
        "total_transaction": "Total transaction",
        "amount_to_return": "Amount to return",
        "rates_summary": "Sum of rates that will disappear",
        "over_x_months": "Over X months",
        "sum": "Sum",
        "uncategorized": "Uncategorized",
        "success": "Success",
        "error": "Error",
        "pdf_processed_successfully": "PDF processed successfully!",
        "failed_to_process_pdf": "Failed to process PDF:",
        "please_select_pdf": "Please select a PDF file",
        "please_select_parser": "Please select a parser",
        "please_select_excel": "Please select an Excel file",
        "please_specify_output": "Please specify output file",
        "starting_processing": "Starting PDF processing...",
        "auto_detected_parser": "Auto-detected parser:",
        "could_not_auto_detect": "Could not auto-detect parser. Please select manually.",
        "loaded_rules": "Loaded {} rules from rules table (use_rules={}, no_rules={})",
        "successfully_created": "Successfully created Excel file: {}",
        "successfully_updated": "Successfully updated Excel file: {}",
        "no_transactions_found": "No transactions found in PDF",
        "failed_to_create_excel": "Failed to create Excel file: {}",
        "failed_to_process_pdf_error": "Failed to process PDF: {}",
        "unexpected_error": "Unexpected error: {}",
        "openpyxl_required": "openpyxl is required for modifying existing Excel files. Install with: pip install openpyxl",
        "failed_to_update_excel": "Failed to update Excel file: {}",
        "pdf_password": "A password is required in order to decrypt this PDF",
        "password_cancelled": "Incorrect password",
    },
    "ro": {
        "app_title": "Parser PDF - Procesor Extrase Bancare",
        "parser": "Parser:",
        "pdf_file": "Fișier PDF:",
        "excel_file": "Fișier Excel (Opțional):",
        "language": "Limbă:",
        "select_existing_excel": "Selectați fișier Excel existent",
        "rules": "Reguli:",
        "enable_rules": "Activează regulile",
        "do_not_use_rules": "NU folosi regulile",
        "pattern": "Model",
        "category": "Categorie",
        "add": "Adaugă",
        "remove_selected": "Șterge Selectate",
        "output_file": "Fișier Ieșire:",
        "sheet_name": "Nume Foaie:",
        "clear_existing": "Șterge foaia Excel sursă înainte de scriere",
        "process_pdf": "Procesează PDF",
        "status": "Status:",
        "browse": "Navighează",
        "data": "Data",
        "details": "Detalii",
        "rate_nr": "Rata nr",
        "num_rates": "Numărul de rate",
        "store": "Magazin",
        "transaction_nr": "Nr tranzacție",
        "total_transaction": "Total tranzacție",
        "amount_to_return": "Suma de returnat",
        "rates_summary": "Suma ratelor ce vor dispărea",
        "over_x_months": "Peste X luni",
        "sum": "Suma",
        "uncategorized": "Necategorizat",
        "success": "Succes",
        "error": "Eroare",
        "pdf_processed_successfully": "PDF procesat cu succes!",
        "failed_to_process_pdf": "Eșec la procesarea PDF:",
        "please_select_pdf": "Vă rugăm să selectați un fișier PDF",
        "please_select_parser": "Vă rugăm să selectați un parser",
        "please_select_excel": "Vă rugăm să selectați un fișier Excel",
        "please_specify_output": "Vă rugăm să specificați fișierul de ieșire",
        "starting_processing": "Încep procesarea PDF...",
        "auto_detected_parser": "Parser detectat automat:",
        "could_not_auto_detect": "Nu s-a putut detecta automat parserul. Vă rugăm să selectați manual.",
        "loaded_rules": "Încărcate {} reguli din tabelul de reguli (use_rules={}, no_rules={})",
        "successfully_created": "Fișier Excel creat cu succes: {}",
        "successfully_updated": "Fișier Excel actualizat cu succes: {}",
        "no_transactions_found": "Nu s-au găsit tranzacții în PDF",
        "failed_to_create_excel": "Eșec la crearea fișierului Excel: {}",
        "failed_to_process_pdf_error": "Eșec la procesarea PDF: {}",
        "unexpected_error": "Eroare neașteptată: {}",
        "openpyxl_required": "openpyxl este necesar pentru modificarea fișierelor Excel existente. Instalați cu: pip install openpyxl",
        "failed_to_update_excel": "Eșec la actualizarea fișierului Excel: {}",
        "pdf_password": "Introduceți parola pentru a decripta fișierul PDF",
        "password_cancelled": "Parolă incorectă"
    },
}


def get_translation(key: str, language: str = "en") -> str:
    """Get translation for a given key and language"""
    return TRANSLATIONS.get(language, TRANSLATIONS["en"]).get(key, key)


def get_translated_headers(language: str) -> list:
    """Get translated headers for transaction data"""
    return [
        get_translation("data", language),
        get_translation("details", language),
        get_translation("rate_nr", language),
        get_translation("num_rates", language),
        get_translation("store", language),
        get_translation("category", language),
        get_translation("transaction_nr", language),
        get_translation("total_transaction", language),
        get_translation("amount_to_return", language),
    ]
